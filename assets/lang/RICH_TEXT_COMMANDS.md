# 高级文本指令使用说明

本文档说明 `f%` 富文本语法，供 `assets/lang/*.json` 或游戏脚本中的字符串使用。

## 1. 启用方式

- 普通文本：按原样渲染。
- 高级文本：字符串以 **非转义** `f%` 开头时启用解析。

示例：

```text
f%这是一段可解析的高级文本
```

## 2. 基本语法

```text
{command:param>param|command:param}
```

- `|`：分隔多个指令
- `:`：分隔指令与参数
- `>`：分隔同一指令的多参数

## 3. 支持指令

### 3.1 `tc`（Text Color）

修改后续文本前景色。

```text
tc:green
tc:#3AF
tc:#33AAFF
tc:rgb(51,170,255)
tc:green>6
tc:clear
```

参数说明：
- 第一个参数：颜色值
- 第二个参数（可选）：`count`，表示后续多少个字符生效
- `clear`：清理前景色并恢复默认

### 3.2 `bg`（Background）

修改后续文本背景色。

```text
bg:gray
bg:#444
bg:#224466
bg:rgb(34,68,102)
bg:lightblue>8
bg:clear
```

参数说明与 `tc` 相同。

## 4. 颜色格式

支持以下颜色格式：

- 默认颜色名：`green`、`gray`、`yellow`、`light_cyan` 等
- RGB：`rgb(r,g,b)`（无空格）
- 三位十六进制：`#RGB`
- 六位十六进制：`#RRGGBB`

## 5. 混合指令示例

```text
f%你好，{tc:green}这里是绿色{tc:clear}。
f%{bg:lightblue>6}这 6 个字符有背景色{bg:clear}
f%{tc:yellow>3|bg:gray}前三个字符黄字灰底
```

## 6. 转义规则

使用 `\` 对符号转义，不参与解析：

- `\f`
- `f\%`
- `\\`
- `\{`
- `\}`

## 7. 错误与渲染行为

可能出现的错误类型：

- 指令为空（如 `{}`）
- 指令无效
- 参数无效
- 缺少成对括号
- 样式未清理（未使用 `clear` 且未设置 `count`）

错误片段会以红色文本形式显示，格式类似：

```text
原文本{错误}原文本
```

## 8. 推荐写法

1. 对长期样式用 `clear` 成对收尾。
2. 对短样式优先使用 `count`，避免忘记清理。
3. 一条指令块里可以用 `|` 合并多条指令，减少文本碎片。

## 9. 完整示例

```text
f%这是默认文本，{tc:green}绿色文字{tc:clear}，{bg:#335577>6}六字符背景{bg:clear}，{tc:yellow>3|bg:gray}混合效果。
```
