# 空中射击（shooter.lua）数值总表

> 数据来源：`scripts/shooter.lua` 当前实现（以代码为准）

## 1. 敌机基础数值

| 敌机类型 | 符号 | 基础分数 | 基础血量 | 基础速度 | 基础撞击伤害 | 是否射击 | 子弹类型 | 子弹基础伤害 | 子弹追踪 |
|---|---|---:|---:|---:|---:|---|---|---:|---|
| 普通机 (normal) | `V` | 2 | 2 | 2 | 2 | 是 | `v` | 1 | 否 |
| 快速机 (fast) | `Y` | 1 | 1 | 4 | 3 | 否 | - | 0 | 否 |
| 肉装机 (tank) | `W` | 3 | 6 | 1 | 4 | 是 | `v` | 1 | 否 |
| 高伤机 (heavy) | `U` | 4 | 2 | 2 | 2 | 是 | `u` | 4 | 是 |

### 敌机实际移动速度（已按你最近改动减半）

代码为：`move_interval = speed_to_interval(def.speed / 4)`。

| 敌机类型 | 计算速度（格/秒） |
|---|---:|
| 普通机 | 0.5 |
| 快速机 | 1.0 |
| 肉装机 | 0.25 |
| 高伤机 | 0.5 |

## 2. BOSS 数值

| 项目 | 数值 / 规则 |
|---|---|
| 基础分数 | 20 |
| 基础血量 | 30 |
| 实际血量 | `floor(30 * max(1, stage / 2))` |
| 出现条件（首个） | 当局分数 `>= 200` |
| 后续触发阈值 | `next_boss_score = cur + 200 + 50 * next_stage` |
| 移动方式 | 仅左右移动 |
| 移动频率 | 每 2 秒最多移动 1 格 |
| 开火频率 | 每 1 秒 1 发（部分模式除外） |
| 模式切换周期 | 每次持续 `3~6` 秒 |
| 模式权重 | attack 40%、predict 35%、dodge 15%、summon 10% |
| 召唤模式 | 每次召唤 `2~5` 架普通敌机 |
| 绝杀条件 | BOSS 出场 180 秒未击杀，直接判玩家失败 |

### BOSS 子弹概率

| 模式 | `v`（1伤） | `·`（2伤） | `u`（4伤，追踪） |
|---|---:|---:|---:|
| attack | 70% | 20% | 10% |
| predict | 60% | 20% | 20% |

## 3. 难度公式（阶段缩放）

| 项目 | 公式 |
|---|---|
| 玩家子弹实际伤害 | `max(1, floor(base * max(1, stage / 2)))` |
| 敌方子弹实际伤害 | `clamp(floor(base * max(1, stage / 2)), 1, 10)` |
| 敌机实际血量 | `base + floor(max(1, stage ^ 1.5 / 3))` |
| 敌机实际撞击伤害 | `clamp(base + floor(max(1, stage / 4)), 1, 10)` |
| BOSS 实际血量 | `max(1, floor(base * max(1, stage / 2)))` |
| 敌机刷新间隔 | `max(1.0, 3.0 - stage * 0.12)` 秒 |
| 关卡提升 | 击败 BOSS 后 `stage = stage + 1` |

## 4. 玩家数值

| 项目 | 数值 / 规则 |
|---|---|
| 初始血量 | 10 |
| 血量上限 | 10 |
| 初始阶段 | 1 |
| 初始分数 | 0 |
| 初始位置 | 行：`PLAYER_ROW=16`，列：`(2+29)/2` 向下取整 = 15 |
| 可移动列 | 2~29 |
| 移动方式 | 左右按键，每次 1 格 |
| 基础自动射速 | 1 发/秒 |
| 加速器射速 | 2 发/秒（持续 2 秒） |
| 受伤无敌 | 2 秒 |
| 护盾无敌 | 2 秒（可覆盖受伤无敌） |
| 失败条件 | 血量 `<= 0` |

## 5. 道具数值

### 5.1 刷新与概率

- 道具刷新间隔：`5~10` 秒随机。
- 先选大类：攻击道具 60%，功能道具 40%。

| 道具 | 类型 | 组内概率 | 全局概率 | 持续时间 | 效果 |
|---|---|---:|---:|---:|---|
| `@` 加速器 | 攻击 | 20% | 12% | 2秒 | 攻速翻倍（1发/秒 -> 2发/秒） |
| `%` 激光器 | 攻击 | 20% | 12% | 5秒 | 子弹变激光 `\|`，可穿透 |
| `$` 双发器 | 攻击 | 20% | 12% | 5秒 | 子弹变双发 `:` |
| `#` 点射器 | 攻击 | 20% | 12% | 5秒 | 子弹变重弹（基础3伤） |
| `&` 导弹发射器 | 攻击 | 20% | 12% | 6秒 | 导弹模式，2秒1发，共3发 |
| `*` 无敌护盾 | 功能 | 25% | 10% | 2秒 | 玩家无敌 |
| `~` 生命恢复器 | 功能 | 5% | 2% | 即时 | 恢复1点血（不超过10） |
| `o` 金币 | 功能 | 50% | 20% | 即时 | +10分 |
| `c` 磁铁 | 功能 | 10% | 4% | 10秒 | 吸附附近道具；重复拾取时间叠加 |
| `+` 子弹加速器 | 功能 | 10% | 4% | 10秒 | 玩家子弹速度x2；重复拾取时间覆盖 |

### 5.2 叠加规则

| 类型 | 规则 |
|---|---|
| 攻击类（`@ % $ # &`） | 互相覆盖（后拾取覆盖前一个） |
| `c` 磁铁 | 时间叠加 |
| `+` 子弹加速器 | 时间覆盖 |
| `*` 护盾 | 时间覆盖 |
| `~` 治疗 | 即时生效，最多到10血 |

## 6. 子弹数值

### 6.1 玩家子弹

| 类型 | 符号 | 基础伤害 | 实际伤害公式 | 基础速度 | 特性 |
|---|---|---:|---|---|---|
| 普通弹 | `^` | 1 | `scale_player_dmg(1)` | 2格/秒 | 命中即消失 |
| 激光弹 | `\|` | 1 | `scale_player_dmg(1)` | 2格/秒 | 穿透同列目标 |
| 双发弹 | `:` | 1 | `scale_player_dmg(1)` | 2格/秒 | 触发双段判定（可转普通弹续飞） |
| 点射弹 | `·`（逻辑） | 3 | `scale_player_dmg(3)` | 2格/秒 | 高伤单发 |
| 导弹 | `!` | 4 | `scale_player_dmg(4)` | 1格/秒 | 软追踪；仅导弹模式发射 |

> 备注：当 `+` 子弹加速器生效时，玩家子弹速度再乘以2。

### 6.2 敌方子弹

| 类型 | 符号 | 基础伤害 | 实际伤害公式 | 速度 | 追踪 |
|---|---|---:|---|---|---|
| 普通弹 | `v` | 1 | `scale_enemy_bullet_dmg(1)` | 1格/秒 | 否 |
| 强化弹 | `·` | 2 | `scale_enemy_bullet_dmg(2)` | 1格/秒 | 否 |
| 导弹 | `u` | 4 | `scale_enemy_bullet_dmg(4)` | 1格/秒 | 是 |

## 7. 记录数值（当前实现）

| 记录项 | 说明 |
|---|---|
| 历史最高分 | `best_score` |
| 历史最高阶段 | `best_stage` |
| 保存时机 | 结算提交时写入（以及手动存档快照） |
