# TUI GAME 已实现游戏规则总览

本文档用于汇总当前仓库中**已实现且可游玩**的游戏规则、机制、符号含义与操作方式，便于后续编写玩家说明。

## 0. 通用说明

- 进入方式：主菜单 `Play Game` 进入游戏列表，选择游戏后回车启动。
- 继续游戏：主菜单 `Continue` 会尝试从统一存档系统读取最近一次可继续的游戏。
- 输入防预读：多数游戏在关键阶段会清理输入缓冲，避免“预输入”作弊。
- 尺寸保护：所有游戏都带最小终端尺寸检测，尺寸不足时显示警告。
- 国际化：运行时文案基于 `assets/lang/*.json`。

## 1. 已实现可游玩游戏（12款）

| 游戏 | 存档 | 最佳记录 |
|---|---|---|
| 2048 | 支持（手动+自动） | 最高分、最短达成时间 |
| 数字华容道（Sliding Puzzle） | 支持（手动+自动） | 最少步数、最短时间 |
| 贪吃蛇（Snake） | 支持（手动） | 最高分、最长游玩时间 |
| 点灯游戏（Lights Out） | 支持（手动+自动） | 最大棋盘、最少步数、最短时间 |
| 记忆翻牌（Memory Flip） | 支持（手动+自动） | 最高难度、最少步数、最短时间 |
| 扫雷（Minesweeper） | 支持（手动+自动） | 官方难度 1/2/3 最短时间 |
| 走迷宫（Maze Escape） | 支持（手动+自动） | 最大地图、最高模式、最快速度 |
| 吃豆人（Pac-Man） | 不支持 | 最高分 |
| 石头剪刀布（Rock Paper Scissors） | 不支持 | 最大连胜 |
| 二十一点（Blackjack） | 不支持 | 历史最高净收益 |
| 颜色记忆（Color Memory） | 不支持 | 最高分、最长游玩时间 |
| 空中射击（Air Shooter） | 支持（手动） | 历史最高分、历史最高阶段 |

---

## 2. 2048

### 目标与结算
- 目标：合成 `131072`。
- 失败：棋盘无可移动/合并位置。
- 达成目标后会显示胜利提示，游戏可继续操作。

### 核心规则
- 棋盘：`4x4`。
- 初始：随机生成 2 个数字。
- 新数字概率：`2`（90%）、`4`（10%）。
- 每次有效移动后生成新数字；无效移动不生成。
- 分数：按每次合并后的数值累加。

### 符号与显示
- 空格显示为 `.`。
- 数字超过可视宽度会简写（如 `k/m/g`）。
- 数字底色按等级渐变（白 -> 红 -> 深红 -> 黑）。

### 操作
- `[↑][↓][←][→]` 移动。
- `[R]` 重开（对局中二次确认）。
- `[S]` 保存。
- `[Q]/[ESC]` 退出（对局中二次确认）。
- 游戏结束后按 `[Y]/[N]` 处理重开/返回。

---

## 3. 数字华容道（Number Sliding Puzzle）

### 目标与结算
- 目标状态：
  - 第一行到第四行依次为 `1..15`，右下角为空。
- 胜利提示：所有数字已按顺序排列。

### 核心规则
- 棋盘：`4x4`。
- 打乱：从终局反向移动 `80~120` 步，保证可解。
- 计分维度：步数 + 用时。

### 移动模式
- `空格移动`（默认）：方向键表示空格朝该方向移动。
- `数字移动`：方向键表示数字朝该方向移动（内部等价为空格反向移动）。

### 操作
- `[↑][↓][←][→]` 移动。
- `[X]` 切换移动模式（空格移动/数字移动）。
- `[S]` 保存。
- `[R]` 重开（二次确认）。
- `[Q]/[ESC]` 退出（二次确认）。

---

## 4. 贪吃蛇（Snake）

### 目标与结算
- 胜利：蛇身填满所有可移动格。
- 失败：蛇头撞到自身身体。

### 核心规则
- 地图：`24x10`（边框外另有双线框）。
- 边界连通（穿墙从对侧出现），不会撞墙死。
- 初始长度：3。
- 基础速度：每秒 2 格。
- 普通食物每次 +10 分并增长 1 节。
- 每吃 15 个普通食物触发高级食物刷新逻辑。
- 高级食物 +25 分并触发 5 秒加速（每秒 4 格）。

### 符号
- 蛇头：`█`（黄）。
- 蛇身/尾：`█`（绿）。
- 普通食物：`$`（橙）。
- 高级食物：`%`（淡蓝）。

### 操作
- `[↑][↓][←][→]` 移动。
- `[S]` 保存。
- `[R]` 重开（对局中二次确认；结算后直接重开）。
- `[Q]/[ESC]` 退出（对局中二次确认；结算后直接退出）。

---

## 5. 点灯游戏（Lights Out）

### 目标与结算
- 胜利：全灯点亮。
- 胜利提示：您已点亮全部灯光。

### 核心规则
- 默认棋盘：`5x5`。
- 支持大小：`2~10`。
- 每次翻转会影响“当前格 + 上下左右”十字区域。
- 统计：步数、用时。

### 符号
- 亮灯：`██`（亮黄）。
- 灭灯：`██`（淡灰）。
- 光标框：单线绿色框。

### 操作
- `[↑][↓][←][→]` 移动光标。
- `[Space]` 翻转十字。
- `[P]` 输入棋盘大小（2~10）。
- `[D]` 输入坐标快速定位（`row col`）。
- `[S]` 保存。
- `[R]` 重开、`[Q]/[ESC]` 退出（对局中二次确认）。

---

## 6. 记忆翻牌（Memory Flip）

### 目标与结算
- 目标：翻出所有配对卡牌。
- 胜利提示：所有牌都已成对。

### 核心规则
- 难度与棋盘：
  - 难度1：`2x2`（2对）
  - 难度2：`4x4`（8对，默认）
  - 难度3：`6x6`（18对）
- 每回合翻两张：
  - 相同：保持翻开。
  - 不同：短暂显示后盖回。
- 统计：步数、用时。

### 符号
- 牌背：`..`。
- 牌面：成对符号（`!! @@ ## ...`）+ 颜色底。
- 选中框：绿色单线框。

### 操作
- `[↑][↓][←][→]` 移动。
- `[Space]` 翻牌。
- `[P]` 输入 `1/2/3` 切换难度。
- `[D]` 输入 `row col` 快速定位。
- `[S]` 保存。
- `[R]` 重开、`[Q]/[ESC]` 退出（对局中二次确认）。

---

## 7. 扫雷（Minesweeper）

### 目标与结算
- 胜利：**所有非雷格都被打开**。
- 失败：踩中地雷。

### 核心规则
- 官方难度：
  - 1：`9x9, 10雷`
  - 2：`16x16, 40雷`
  - 3：`16x30, 99雷`
- 自定义上限：`22行 x 32列`，雷数 `1..(行*列-1)`。
- 首次打开必非雷。
- 标记 `!`/`?` 的格子按空格不会被打开。
- 表情状态：`ovo`（平时）/`oOo`（动作）/`$o$`（胜）/`X_X`（败）。

### 符号
- 未开：`#`（白）
- 旗标：`!`（橙）
- 可疑：`?`（蓝）
- 雷：`@`（红）
- 空白已开：`.`（灰）
- 数字：`1..8`（分色）
- 光标：黄底高亮（`!/#` 在光标下转黑字）

### 操作
- `[↑][↓][←][→]` 移动。
- `[Space]` 打开。
- `[Z]` 标雷。
- `[X]` 标记可疑。
- `[P]` 改难度/自定义（输入 `1/2/3` 或 `row col mines`）。
- `[D]` 跳转坐标（输入 `row col`）。
- `[S]` 保存。
- `[R]` 重开、`[Q]/[ESC]` 退出（对局中二次确认；结算后直接操作）。

---

## 8. 走迷宫（Maze Escape）

### 目标与结算
- 胜利：到达终点 `&`。
- 失败：限时模式倒计时归零。

### 核心规则
- 地图范围：列 `10~32`，行 `8~22`。
- 四种模式：
  - 1 普通（无门钥、无限时）
  - 2 门钥（有 `%` 门与 `*` 钥匙）
  - 3 限时（无门钥）
  - 4 限时+门钥
- 限时公式：`最短路径格数 * 0.5 + 钥匙数 * 3`（秒，四舍五入后至少1秒）。
- 钥匙数量按面积动态估算，门钥一一对应；拾钥匙可开任意门。

### 符号
- 墙：`█`
- 通路：空格
- 玩家：`@`
- 门：`%`
- 钥匙：`*`
- 终点：`&`

### 操作
- `[↑][↓][←][→]` 移动。
- `[P]` 改地图参数（输入 `mode` 或 `cols rows [mode]`）。
- `[S]` 保存。
- `[R]` 重开、`[Q]/[ESC]` 退出（对局中二次确认）。

---

## 9. 吃豆人（Pac-Man）

### 目标与结算
- 单关目标：吃完所有豆子。
- 最终胜利：完成第 20 关。
- 失败：生命归零。

### 核心规则
- 玩家符号：`@`（普通黄；大力丸期间青）。
- 豆子：
  - 普通豆 `·`：10分
  - 大力丸 `*`：50分，触发可吃鬼状态
- 大力丸期间吃鬼连击得分：`200/400/800/1600`。
- 四鬼 AI 差异化（Blinky/Pinky/Inky/Clyde），并随关卡调整节奏。
- 额外生命：分数达到 10000 时奖励 1 次。
- 收集物按关卡切换（`% U O Q § W ? !`），位置为地图内可达且不覆盖豆子位置。

### 关键符号
- 墙体双线字符（蓝）。
- 鬼门：`-`（白）。
- 鬼：`&`（红/粉/青/橙）。
- 收集物：`% U O Q § W ? !`（品红）。

### 操作
- `[↑][↓][←][→]` 移动。
- `[R]` 重开（对局中二次确认，结算后直接重开）。
- `[Q]/[ESC]` 退出（对局中二次确认，结算后直接退出）。

---

## 10. 石头剪刀布（Rock Paper Scissors）

### 目标与结算
- 标准猜拳规则，人机对战。
- 记录最大连胜。

### 符号
- `Y` = 剪刀
- `O` = 石头
- `U` = 布

### 操作
- `[1]` 剪刀，`[2]` 石头，`[3]` 布。
- `[R]` 重开连胜。
- `[Q]/[ESC]` 退出。

---

## 11. 二十一点（Blackjack）

### 目标与结算
- 目标：通过要牌/停牌/分牌/倍率等策略，让自己的结果优于庄家并获得净收益。
- 破产（资金<=0）会进入破产提示状态。
- 退出时会更新“历史最高净收益”。

### 核心规则（当前实现）
- 初始资金：1000。
- A 计分：优先 11，超 21 时按 1 回退。
- `J/Q/K` 计 10。
- 支持：要牌、停牌、加倍、分牌、保险、倍率调整、左右切手牌。
- 分牌后左右手可独立结算。
- 保险（当前实现条件）：仅玩家阶段首操作、未分牌、非黑杰克、两张手牌总点数 < 17，可触发“本轮跳过并使下一轮强制双倍”。

### 操作
- `[+]/[-]` 调整倍率。
- `[←]/[→]` 切换手牌（分牌后）。
- `[Space]` 要牌。
- `[Enter]` 停牌。
- `[Z]` 加倍。
- `[X]` 分牌。
- `[C]` 保险。
- `[R]` 重开（二次确认）。
- `[Q]/[ESC]` 退出（二次确认）。

### 存档
- 不提供 S 存档。

---

## 12. 颜色记忆（Color Memory）

### 目标与结算
- 系统按“第 N 局显示 N 个颜色”的规则出题。
- 玩家按顺序输入并手动提交。
- 任一局提交错误则失败。

### 核心规则
- 颜色集合：红、黄、蓝、绿。
- 展示节奏：单个高亮显示 1.2s，熄灭间隔 0.8s。
- 每过一局加分：本局号数（例如第3局 +3分）。

### 操作
- `[1][2][3][4]` 输入颜色。
- `[Backspace]/[Delete]` 删除最后输入。
- `[Enter]` 提交答案（不会自动提交）。
- `[R]` 重开（二次确认）。
- `[Q]/[ESC]` 退出（二次确认）。

### 存档
- 无进度存档。

---

## 13. 空中射击（Air Shooter）

### 目标与结算
- 无限关卡生存，击毁敌机/BOSS，提升分数与阶段。
- 失败条件：生命归零。

### 地图与单位
- 游戏区：`32x18`（双线边框），玩家活动列为内部第2~29列。
- 玩家：`A`（黄，受击短暂无敌闪烁），生命 10。
- 敌机：
  - 普通 `V`（2分，HP2）
  - 快速 `Y`（1分，HP1）
  - 肉装 `W`（3分，HP6）
  - 高伤 `U`（4分，HP2，导弹）
- BOSS：由 `███` + 中心块构成，独立模式与血条。

### 子弹与道具
- 我方子弹：`^`（普通）、`|`（激光）、`:`（双发）、`·`（点射）、`!`（导弹）。
- 敌方子弹：`v`（普通）、`·`（重弹）、`u`（导弹）。
- 子弹对撞：仅导弹参与耐久碰撞（玩家导弹 HP2，敌导弹 HP4）。
- 攻击道具：`@ % $ # &`。
- 功能道具：`* ~ o c +`。
- 主动道具核弹：`G`（弹舱最多3个），`[X]`使用：清屏并对BOSS造成固定伤害，附带自损。

### BOSS机制
- 首次触发分数：100。
- 后续阈值：`next = current + 100 + 50 * next_stage`。
- 模式：攻击 / 预判 / 躲避 / 召唤 / 追击（含冷却）。
- 在场时显示 20 格血条 + 百分比。

### 操作
- `[LEFT]/[RIGHT]` 移动。
- `[Z]` 切换开火模式（自动/手动）。
- `[Space]` 手动开火。
- `[X]` 核弹。
- `[S]` 保存。
- `[R]` 重开（对局中二次确认；失败后直接重开）。
- `[Q]/[ESC]` 退出（对局中二次确认；失败后直接退出）。

---

## 14. 当前仍为占位（未实现完整逻辑）

以下脚本目前仅占位元信息，尚未实现可玩逻辑：

- 井字棋 `tic_tac_toe.lua`
- 俄罗斯方块 `tetris.lua`
- 24点 `twenty_four.lua`
- Wordle `wordle.lua`
- 单人纸牌 `solitaire.lua`
- 数独 `sudoku.lua`

---

## 15. 备注

- 本文以当前代码实现为准（`scripts/*.lua`）。
- 若后续你继续调参数/规则，建议同步更新本文件对应章节，确保玩家文档与实际玩法一致。


